% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/panoramic-spatialstats.R
\name{panoramic}
\alias{panoramic}
\title{PANORAMIC: prepare and compute spatial statistics}
\usage{
panoramic(
  spe_list,
  design,
  cell_type = "cell_type",
  pairs = "auto",
  radii_um,
  stat = "Lcross",
  nsim = 100,
  correction = "translate",
  min_cells = 5L,
  concavity = 50,
  window = "concave",
  keep_boot = FALSE,
  seed = 123,
  BPPARAM = BiocParallel::SerialParam()
)
}
\arguments{
\item{spe_list}{Named or unnamed list of SpatialExperiment (one per sample)}

\item{design}{data.frame with at least columns \code{sample}, \code{group} to map samples for meta-analysis. If only one group is used, give all the same group label.}

\item{cell_type}{Character; name of SpatialExperiment colData column holding cell type labels}

\item{pairs}{Either "auto" (generate all cell-type pairs including self-pairs)
or a data.frame with columns \code{ct1}, \code{ct2}.}

\item{radii_um}{Numeric vector of radii (microns) at which to evaluate the colocalization statistic.}

\item{stat}{Character. Summary statistic ("Lcross", "Lest", "Kcross", "Kest").}

\item{nsim}{Integer. Number of Loh bootstrap simulations per sample/pair.}

\item{correction}{Chatacter. Edge correction method for spatstat ("translate", "border", ...).}

\item{min_cells}{Integer. Cell types with fewer than this count (per sample) are dropped.}

\item{concavity}{Numeric passed to concaveman::concaveman(). Controls level of hull detail. 1 is highly detailed, \code{Inf} is a convex hull.}

\item{window}{one of "concave","convex","rect". Typically use concave.}

\item{keep_boot}{Logical. Reserved for future use (keeping full bootstrap objects).}

\item{seed}{Integer random seed for reproducible bootstrap simulations.}

\item{BPPARAM}{BiocParallel param for optional parallel processing.}
}
\value{
A SummerizedExperiment as described in \code{panoramic_spatialstats()}.
}
\description{
One-line convenience wrapper that calles \code{panoramic_prepare()} followed
by \code{panoramic_spatialstats()} to produce the PANORAMIC
SummarizedExperiment for donwnstream meta-analysis.
}
\examples{
library(SpatialExperiment)
library(S4Vectors)
library(BiocParallel)

set.seed(1)

make_spe <- function(n_cells, sample_id) {
  coords <- cbind(
    x = runif(n_cells, 0, 100),
    y = runif(n_cells, 0, 100)
  )
  ct <- sample(c("A", "B"), size = n_cells, replace = TRUE)

  counts <- matrix(
    rpois(5 * n_cells, lambda = 5),
    nrow = 5,
    dimnames = list(
      paste0("gene", seq_len(5)),
      paste0(sample_id, "_cell", seq_len(n_cells))
    )
  )

  SpatialExperiment::SpatialExperiment(
    assays = list(counts = counts),
    colData = S4Vectors::DataFrame(
      cell_type = ct,
      sample_id = sample_id
    ),
    spatialCoords = coords
  )
}

spe1 <- make_spe(20, "sample1")
spe2 <- make_spe(22, "sample2")

spe_list <- list(sample1 = spe1, sample2 = spe2)

design <- data.frame(
  sample = c("sample1", "sample2"),
  group  = c("group1", "group1"),
  stringsAsFactors = FALSE
)

se_stats <- panoramic(
  spe_list,
  design      = design,
  cell_type   = "cell_type",
  radii_um    = c(10, 20),
  stat        = "Lcross",
  nsim        = 5,
  correction  = "translate",
  min_cells   = 2,
  concavity   = 50,
  window      = "rect",
  seed        = 1,
  BPPARAM     = BiocParallel::SerialParam()
)

se_stats
}
